<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M.Tech Admission - Global College of Engineering & Technology</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Razorpay Checkout JS (for simulated integration) -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <!-- jsPDF and html2canvas for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* CSS Variables from Sooper Store */
        :root {
            --primary: #28a745; /* Green */
            --primary-light: #5cb85c;
            --primary-dark: #218838;
            --secondary: #98cce0; /* Light Blue */
            --dark: #333;
            --light: #f8f9fa;
            --danger: #dc3545; /* Red */
            --success: #28a745; /* Green */
            --warning: #ffc107; /* Yellow */
            --blue-college: #0d4a96; /* Darker Blue */
            --blue-college-light: #1a6fc9; /* Lighter Blue */
        }

        /* General styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif; /* Using Inter font */
        }

        body {
            background: linear-gradient(135deg, var(--blue-college) 0%, var(--blue-college-light) 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        .container {
            background: white;
            border-radius: 20px; /* More rounded */
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25); /* Deeper shadow */
            width: 100%;
            max-width: 960px; /* Increased max-width */
            overflow: hidden;
            position: relative;
        }

        /* Header styling */
        .header {
            background: linear-gradient(90deg, var(--blue-college) 0%, var(--blue-college-light) 100%);
            color: white;
            padding: 40px 30px; /* More padding */
            text-align: center;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
        }

        .logo-icon-circle {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .logo-icon-circle i {
            font-size: 45px;
            color: var(--blue-college);
        }

        .logo-text {
            text-align: left;
        }

        .logo-text h1 {
            font-size: 28px;
            font-weight: 800;
            line-height: 1.2;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }

        .logo-text p {
            font-size: 16px;
            opacity: 0.95;
            margin-top: 8px;
        }

        .title {
            font-size: 38px;
            font-weight: 800;
            margin: 25px 0 20px;
            position: relative;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.15);
        }

        .title::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 5px;
            background: var(--warning); /* Brighter yellow accent */
            border-radius: 3px;
        }

        .subtitle {
            font-size: 20px;
            margin-top: 15px;
            opacity: 0.9;
        }

        /* Content area */
        .content {
            padding: 40px;
        }

        /* Eligibility Section */
        .eligibility {
            background: #e6f7ff; /* Lighter blue background */
            border-left: 5px solid var(--success); /* Green accent border */
            padding: 25px;
            margin-bottom: 35px; /* More space */
            border-radius: 10px; /* Rounded corners */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08); /* Subtle shadow */
        }

        .eligibility h3 {
            color: var(--success);
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 22px;
            font-weight: 700;
        }

        .eligibility ul {
            padding-left: 25px;
            list-style: disc; /* Ensure disc bullets */
        }

        .eligibility li {
            margin-bottom: 10px;
            font-size: 17px;
            line-height: 1.6;
            color: var(--dark);
        }

        /* Form styling */
        .section-title {
            font-size: 24px; /* Larger section titles */
            color: var(--blue-college);
            margin: 35px 0 20px; /* More vertical spacing */
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 25px; /* More space between groups */
        }

        .form-row {
            display: flex;
            gap: 25px; /* Increased gap */
            margin-bottom: 25px;
        }

        .form-col {
            flex: 1;
        }

        label {
            display: block;
            margin-bottom: 10px; /* More space below label */
            font-weight: 600;
            color: var(--dark);
            font-size: 16px;
        }

        .required:after {
            content: " *";
            color: var(--danger); /* Red for required fields */
        }

        input, select, textarea {
            width: 100%;
            padding: 15px 18px; /* Larger padding */
            border: 1px solid #ced4da; /* Softer border */
            border-radius: 10px; /* More rounded */
            font-size: 17px; /* Larger font */
            transition: all 0.3s ease;
            color: var(--dark);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--blue-college-light);
            box-shadow: 0 0 0 4px rgba(26, 111, 201, 0.25); /* More prominent focus shadow */
            outline: none;
        }

        /* Photo upload */
        .photo-upload {
            display: flex;
            align-items: center;
            gap: 40px; /* More space */
            margin: 35px 0;
            padding: 30px;
            border: 2px dashed #a0c4ff;
            border-radius: 15px;
            background: #f8fbff;
        }

        .photo-preview {
            width: 160px;
            height: 190px;
            background: #e9ecef;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            flex-shrink: 0;
        }

        .photo-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: none;
        }

        .photo-preview i {
            font-size: 50px;
            color: #adb5bd;
        }

        .upload-instructions {
            flex: 1;
            text-align: left;
        }

        .upload-instructions p {
            margin-bottom: 12px;
            font-size: 16px;
            color: #555;
            line-height: 1.6;
            font-weight: 500;
        }

        .upload-instructions ul {
            padding-left: 25px;
            margin: 15px 0;
            list-style: disc;
        }

        .upload-instructions li {
            margin-bottom: 8px;
            font-size: 15px;
            color: #444;
        }

        /* Exam details */
        .exam-section {
            background: #f0f7ff;
            padding: 30px;
            border-radius: 15px;
            margin: 35px 0;
            border: 1px solid #d0e4ff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .exam-section .form-row {
            margin-top: 20px;
        }

        /* Specialization section */
        .specialization {
            background: #f9f7ff;
            padding: 30px;
            border-radius: 15px;
            margin: 35px 0;
            border: 1px solid #e0d7ff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .specialization-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .specialization-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: #fff;
        }

        .specialization-option:hover {
            border-color: var(--blue-college-light);
            background: #e6f7ff;
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }

        .specialization-option input[type="radio"] {
            width: auto;
            margin-right: 15px;
            transform: scale(1.3);
            cursor: pointer;
        }

        /* Fee Payment Section - Adapted from Sooper Store */
        .fee-payment-section {
            background: #e0ffe0 url('data:image/svg+xml;utf8,<svg width="100" height="100" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="40" fill="none" stroke="%23c3e6cb" stroke-width="2"/></svg>') repeat;
            border: 1px solid #a8e6a8;
            padding: 30px;
            border-radius: 15px;
            margin: 35px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .payment-summary {
            flex: 1;
            min-width: 300px;
            background: var(--light);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .summary-title {
            font-size: 20px;
            margin-bottom: 20px;
            color: var(--dark);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
            position: relative;
        }

        .summary-title::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 50px;
            height: 2px;
            background: var(--primary);
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .summary-item:hover {
            transform: translateX(5px);
        }

        .summary-total {
            font-weight: bold;
            font-size: 26px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid var(--secondary);
            display: flex;
            justify-content: space-between;
            color: var(--primary-dark);
            animation: pulse 2s infinite;
        }

        .payment-options-container {
            flex: 2;
            min-width: 300px;
        }

        .payment-methods {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .method-btn {
            flex: 1;
            padding: 20px 15px;
            border: 2px solid #ddd;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease-in-out;
            font-weight: 500;
            transform: scale(1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        .method-btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .method-btn.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(40, 167, 69, 0.2), rgba(40, 167, 69, 0.1));
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.3);
        }

        .method-icon {
            font-size: 38px;
            margin-bottom: 10px;
            transition: all 0.3s ease-in-out;
            color: #666;
        }

        .method-btn.active .method-icon {
            transform: scale(1.2) rotate(5deg);
            color: var(--primary);
        }

        .payment-details-content {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .payment-form {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.5s ease;
        }

        .payment-form.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .upi-qr-container {
            text-align: center;
            padding: 20px;
        }

        .upi-qr-container h3 {
            margin-bottom: 15px;
            color: var(--dark);
            font-size: 18px;
        }

        .qr-code {
            background: white;
            padding: 25px;
            border-radius: 15px;
            display: inline-block;
            margin: 15px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border: 2px solid var(--primary-light);
            transition: all 0.3s;
        }
        
        .qr-code img {
            width: 200px;
            height: 200px;
            display: block;
            margin: 0 auto;
            border: 3px solid var(--primary);
            border-radius: 8px;
        }

        .qr-code:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }

        .qr-instructions {
            background: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
            font-size: 15px;
            color: #2e7d32;
            text-align: left;
            transition: all 0.3s;
            border: 1px solid var(--success);
        }

        .qr-instructions:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .qr-instructions ol {
            padding-left: 25px;
            margin-top: 15px;
        }

        .qr-instructions li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 20px;
        }

        .qr-instructions li::before {
            content: '→';
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: bold;
        }

        .qr-instructions p {
            margin-bottom: 10px;
        }

        .payment-status {
            margin-top: 20px;
            padding: 25px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            display: none;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .payment-status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .payment-status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-icon {
            font-size: 70px;
            margin-bottom: 25px;
            display: inline-block;
        }

        .status-success .status-icon {
            color: var(--success);
            animation: bounceIn 0.8s;
        }

        .status-pending .status-icon {
            color: var(--warning);
            animation: pulse 1.5s infinite;
        }

        .status-error .status-icon {
            color: var(--danger);
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
            20%, 40%, 60%, 80% { transform: translateX(8px); }
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.4); }
            70% { box-shadow: 0 0 0 15px rgba(40, 167, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
        }
        @keyframes bounceIn {
            0% { transform: scale(0.1); opacity: 0; }
            60% { transform: scale(1.3); opacity: 1; }
            100% { transform: scale(1); }
        }


        .receipt-upload-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px dashed #ccc;
            display: none;
        }

        .receipt-upload-section label {
            font-size: 16px;
            margin-bottom: 10px;
        }

        /* New styles for receipt preview */
        .receipt-preview-container {
            display: flex;
            align-items: center;
            gap: 40px;
            margin: 20px 0;
            padding: 30px;
            border: 2px dashed #a0c4ff;
            border-radius: 15px;
            background: #f8fbff;
            display: none;
        }

        .receipt-preview {
            width: 160px;
            height: 190px;
            background: #e9ecef;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            flex-shrink: 0;
        }

        .receipt-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: none;
        }

        .receipt-preview i {
            font-size: 50px;
            color: #adb5bd;
        }
        .receipt-preview-text {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }


        /* Buttons */
        .btn {
            display: inline-block;
            background: linear-gradient(90deg, var(--blue-college) 0%, var(--blue-college-light) 100%);
            color: white;
            padding: 16px 35px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            margin-top: 10px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .btn:hover {
            background: linear-gradient(90deg, #0a3a7a 0%, #155aa0 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .btn-secondary {
            background: #e9ecef;
            color: var(--dark);
            margin-left: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background: #dee2e6;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .form-note {
            margin-top: 30px;
            padding: 20px;
            background: var(--warning);
            border-radius: 10px;
            border-left: 5px solid var(--warning);
            font-size: 15px;
            color: #856404;
        }

        .form-note p {
            margin-bottom: 10px;
            font-weight: 600;
        }

        .form-note ul {
            padding-left: 25px;
            margin: 15px 0;
            list-style: disc;
        }

        .form-note li {
            margin-bottom: 8px;
            font-size: 15px;
        }

        /* Contact Info */
        .contact-info {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #f0f0f0;
            color: #555;
        }

        .contact-info p {
            margin: 12px 0;
            font-size: 17px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .contact-info i {
            color: var(--blue-college);
            margin-right: 12px;
            width: 25px;
            text-align: center;
        }

        .success-message {
            text-align: center;
            padding: 60px 30px;
            display: none;
        }

        .success-message i {
            font-size: 80px;
            color: var(--success);
            margin-bottom: 30px;
        }

        .success-message h2 {
            font-size: 36px;
            color: var(--blue-college);
            margin-bottom: 20px;
        }

        .success-message p {
            font-size: 19px;
            margin-bottom: 30px;
            line-height: 1.7;
        }

        /* Application Receipt */
        .application-receipt {
            display: none;
            margin-top: 40px;
            padding: 40px;
            background: #f9fbfd;
            border-radius: 15px;
            border: 1px solid #d1e7ff;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }

        .receipt-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .receipt-header h2 {
            font-size: 32px;
            color: var(--blue-college);
            margin-bottom: 10px;
        }

        .receipt-header h3 {
            font-size: 24px;
            color: var(--success);
            margin-bottom: 15px;
        }

        .receipt-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 35px;
        }

        .receipt-section {
            margin-bottom: 35px;
        }

        .receipt-section-title {
            font-size: 20px;
            color: var(--blue-college);
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eaeaea;
            font-weight: 700;
        }

        .receipt-row {
            display: flex;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #e0e0e0;
        }

        .receipt-label {
            font-weight: 600;
            width: 40%;
            color: #555;
        }

        .receipt-value {
            width: 60%;
            font-weight: 500;
            color: var(--dark);
        }

        .payment-details {
            background: #e6f7ff;
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
            border-left: 4px solid var(--blue-college);
        }

        .payment-details .receipt-row {
            border-bottom: none;
            padding-bottom: 0;
        }

        .receipt-footer {
            margin-top: 40px;
            padding-top: 25px;
            border-top: 2px solid #eee;
            text-align: center;
            color: #666;
            font-size: 15px;
        }

        .signature-area {
            margin-top: 30px;
            padding-top: 20px;
            text-align: right;
        }

        .signature-line {
            display: inline-block;
            width: 250px;
            border-top: 1px solid #999;
            margin-top: 60px;
            padding-top: 10px;
            text-align: center;
            color: #555;
        }

        /* Multi-step form specific styles */
        .progress-bar-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }

        .progress-bar {
            height: 15px;
            background-color: var(--success);
            width: 0%;
            border-radius: 10px;
            transition: width 0.5s ease-in-out;
        }

        .step-indicators {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .step-indicator {
            flex: 1;
            text-align: center;
            padding: 10px 0;
            color: #888;
            font-weight: 600;
            position: relative;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .step-indicator.active {
            color: var(--blue-college);
        }

        .step-indicator.completed {
            color: var(--success);
        }

        .step-indicator::before {
            content: attr(data-step);
            display: block;
            width: 30px;
            height: 30px;
            line-height: 30px;
            border-radius: 50%;
            background-color: #ccc;
            color: white;
            margin: 0 auto 10px;
            font-size: 14px;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .step-indicator.active::before {
            background-color: var(--blue-college);
        }

        .step-indicator.completed::before {
            background-color: var(--success);
            content: '✓';
            font-size: 18px;
        }

        .form-step {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .form-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }

        .navigation-buttons .btn {
            margin-top: 0;
        }

        .navigation-buttons .btn-prev {
            background: #6c757d;
        }

        .navigation-buttons .btn-prev:hover {
            background: #5a6268;
        }

        /* Custom Message Box Styles */
        .message-box-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .message-box-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .message-box {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 400px;
            width: 90%;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .message-box-overlay.active .message-box {
            transform: translateY(0);
        }

        .message-box h3 {
            font-size: 24px;
            margin-bottom: 15px;
            color: var(--blue-college);
        }

        .message-box p {
            font-size: 16px;
            color: #555;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .message-box .btn {
            padding: 10px 25px;
            font-size: 16px;
            margin-top: 0;
        }

        .message-box.error h3 {
            color: var(--danger);
        }
        .message-box.warning h3 {
            color: var(--warning);
        }


        /* Responsive design */
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .logo {
                flex-direction: column;
                text-align: center;
            }
            
            .logo-icon-circle {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .logo-text h1 {
                font-size: 22px;
            }

            .title {
                font-size: 32px;
            }

            .content {
                padding: 30px 20px;
            }
            
            .photo-upload {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }
            
            .exam-section .form-row, 
            .specialization-grid,
            .payment-methods {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn-secondary {
                margin-left: 0;
                margin-top: 15px;
            }
            
            .specialization-grid {
                grid-template-columns: 1fr;
            }

            .contact-info p {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            .contact-info i {
                margin-right: 0;
                margin-bottom: 5px;
            }

            .step-indicators {
                flex-wrap: wrap;
                justify-content: center;
                gap: 10px;
            }
            .step-indicator {
                flex-basis: 45%;
                margin-bottom: 10px;
            }
        }

        @media (max-width: 480px) {
            .container {
                border-radius: 15px;
            }
            .header {
                padding: 25px 15px;
            }
            .logo-icon-circle {
                width: 60px;
                height: 60px;
            }
            .logo-icon-circle i {
                font-size: 35px;
            }
            .logo-text h1 {
                font-size: 18px;
            }
            .logo-text p {
                font-size: 13px;
            }
            .title {
                font-size: 28px;
            }
            .subtitle {
                font-size: 16px;
            }
            .content {
                padding: 25px 15px;
            }
            .eligibility h3 {
                font-size: 20px;
            }
            .eligibility li {
                font-size: 15px;
            }
            .section-title {
                font-size: 20px;
            }
            input, select, textarea {
                padding: 12px 15px;
                font-size: 16px;
            }
            .photo-upload {
                padding: 20px;
            }
            .photo-preview {
                width: 140px;
                height: 170px;
            }
            .photo-preview i {
                font-size: 40px;
            }
            .upload-instructions p {
                font-size: 14px;
            }
            .upload-instructions li {
                font-size: 13px;
            }
            .specialization-option {
                padding: 12px;
            }
            .specialization-option input[type="radio"] {
                transform: scale(1.1);
            }
            .fee-payment-section {
                padding: 25px;
            }
            .fee-summary p {
                font-size: 16px;
            }
            .payment-info p {
                font-size: 15px;
            }
            .payment-option-btn {
                padding: 10px 20px;
                font-size: 15px;
            }
            .btn {
                padding: 14px 25px;
                font-size: 16px;
            }
            .form-note {
                padding: 15px;
                font-size: 14px;
            }
            .form-note li {
                font-size: 14px;
            }
            .contact-info p {
                font-size: 14px;
            }
            .step-indicator {
                flex-basis: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon-circle">
                    <i class="fas fa-graduation-cap" style="font-size: 40px; color: var(--blue-college);"></i>
                </div>
                <div class="logo-text">
                    <h1>GLOBAL COLLEGE OF ENGINEERING & TECHNOLOGY, KADAPA</h1>
                    <p>Approved by AICTE, New Delhi & Affiliated to JNTUA, Anantapur</p>
                </div>
            </div>
            <h2 class="title">M.Tech Admission Form 2025-26</h2>
            <p class="subtitle">Complete your pre-booking application for the Master of Technology Program.</p>
        </div>
        
        <div class="content">
            <div class="eligibility">
                <h3><i class="fas fa-check-circle"></i> M.Tech Eligibility Criteria</h3>
                <ul>
                    <li><strong>Academic Qualification:</strong> B.Tech/B.E. in relevant discipline with minimum 50% aggregate (45% for SC/ST)</li>
                    <li><strong>Entrance Exam:</strong> Valid GATE/PGECET score required for admission</li>
                    <li><strong>Age Limit:</strong> No age limit</li>
                    <li><strong>Documents:</strong> 10th, Intermediate, B.Tech/B.E. mark sheets, GATE/PGECET score card, Transfer Certificate (TC), Conduct Certificate (CC)</li>
                    <li><strong>Specializations:</strong> Computer Science, Power Systems, Thermal Engineering, VLSI Design, Control Systems, Digital Electronics</li>
                </ul>
            </div>

            <!-- Progress Bar and Step Indicators -->
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="step-indicators" id="stepIndicators">
                <div class="step-indicator active" data-step="1">Personal & Academic Info</div>
                <div class="step-indicator" data-step="2">Specialization & Exam</div>
                <div class="step-indicator" data-step="3">Upload & Payment</div>
                <div class="step-indicator" data-step="4">Receipt</div>
            </div>
            
            <form id="mtechAdmissionForm">
                <!-- Step 1: Personal Information & Academic Information -->
                <div id="step-1" class="form-step active">
                    <h3 class="section-title">Personal Information</h3>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="fullName" class="required">Full Name</label>
                            <input type="text" id="fullName" name="fullName" required placeholder="Enter your full name">
                        </div>
                        <div class="form-col">
                            <label for="dob" class="required">Date of Birth</label>
                            <input type="date" id="dob" name="dob" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label for="fatherName" class="required">Father's Name</label>
                            <input type="text" id="fatherName" name="fatherName" required placeholder="Enter father's name">
                        </div>
                        <div class="form-col">
                            <label for="motherName" class="required">Mother's Name</label>
                            <input type="text" id="motherName" name="motherName" required placeholder="Enter mother's name">
                        </div>
                    </div>

                    <h3 class="section-title">Academic Information (B.Tech/B.E.)</h3>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="degreeCollege" class="required">Degree College Name</label>
                            <input type="text" id="degreeCollege" name="degreeCollege" required placeholder="Enter degree college name">
                        </div>
                        <div class="form-col">
                            <label for="degreeUniversity" class="required">University</label>
                            <input type="text" id="degreeUniversity" name="degreeUniversity" required placeholder="Enter university name">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label for="degreePercentage" class="required">Degree Percentage</label>
                            <input type="number" id="degreePercentage" name="degreePercentage" min="0" max="100" step="0.01" required placeholder="Enter percentage">
                        </div>
                        <div class="form-col">
                            <label for="degreeYear" class="required">Year of Passing</label>
                            <select id="degreeYear" name="degreeYear" required>
                                <option value="">Select Year</option>
                                <option value="2022">2022</option>
                                <option value="2023">2023</option>
                                <option value="2024">2024</option>
                                <option value="2025">2025</option> <!-- Added 2025 -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label for="degreeStream" class="required">Undergraduate Stream</label>
                            <input type="text" id="degreeStream" name="degreeStream" required placeholder="e.g., Computer Science Engineering">
                        </div>
                        <div class="form-col">
                            <label for="intermediatePercentage" class="required">Intermediate (10+2) Percentage</label>
                            <input type="number" id="intermediatePercentage" name="intermediatePercentage" min="0" max="100" step="0.01" required placeholder="Enter 10+2 percentage">
                        </div>
                    </div>

                    <h3 class="section-title">Contact Information</h3>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="email" class="required">Email Address</label>
                            <input type="email" id="email" name="email" required placeholder="Enter your email">
                        </div>
                        <div class="form-col">
                            <label for="phone" class="required">Phone Number</label>
                            <input type="tel" id="phone" name="phone" required placeholder="Enter your phone number">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="address" class="required">Permanent Address</label>
                        <textarea id="address" name="address" rows="3" required placeholder="Enter your full address"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <label for="city" class="required">City</label>
                            <input type="text" id="city" name="city" required placeholder="Enter your city">
                        </div>
                        <div class="form-col">
                            <label for="state" class="required">State</label>
                            <input type="text" id="state" name="state" required placeholder="Enter your state">
                        </div>
                        <div class="form-col">
                            <label for="pincode" class="required">Pincode</label>
                            <input type="text" id="pincode" name="pincode" required placeholder="Enter pincode">
                        </div>
                    </div>

                    <div class="navigation-buttons">
                        <button type="button" class="btn btn-prev" style="visibility: hidden;">Previous</button>
                        <button type="button" class="btn btn-next">Next</button>
                    </div>
                </div>
                
                <!-- Step 2: Specialization Preference & Admission Type/Entrance Exam Details -->
                <div id="step-2" class="form-step">
                    <h3 class="section-title">Specialization Preference</h3>
                    <div class="specialization">
                        <p>Select your preferred M.Tech specialization:</p>
                        <div class="specialization-grid">
                            <label class="specialization-option">
                                <input type="radio" name="specialization" value="cse" required>
                                CSE (Computer Science & Engineering)
                            </label>
                            <label class="specialization-option">
                                <input type="radio" name="specialization" value="ps">
                                PS (Power Systems)
                            </label>
                            <label class="specialization-option">
                                <input type="radio" name="specialization" value="tses">
                                TSES (Thermal Engineering & Solar Energy Systems)
                            </label>
                            <label class="specialization-option">
                                <input type="radio" name="specialization" value="vlsid">
                                VLSID (VLSI Design)
                            </label>
                            <label class="specialization-option">
                                <input type="radio" name="specialization" value="cpm">
                                CPM (Construction Project Management)
                            </label>
                            <label class="specialization-option">
                                <input type="radio" name="specialization" value="decs">
                                DECS (Digital Electronics & Communication Systems)
                            </label>
                            <label class="specialization-option">
                                <input type="radio" name="specialization" value="other">
                                Other
                            </label>
                        </div>
                    </div>
                    
                    <h3 class="section-title">Admission Type & Entrance Exam Details</h3>
                    <div class="exam-section">
                        <div class="form-group">
                            <label class="required">Select Admission Type:</label>
                            <div class="specialization-grid">
                                <label class="specialization-option">
                                    <input type="radio" name="admissionType" value="qualified" id="admissionTypeQualified" required checked>
                                    Entrance Exam Qualified
                                </label>
                                <label class="specialization-option">
                                    <input type="radio" name="admissionType" value="paid" id="admissionTypePaid">
                                    Paid Admission (Management Quota)
                                </label>
                            </div>
                        </div>

                        <div id="entranceExamDetails" style="display: block;">
                            <div class="form-row">
                                <div class="form-col">
                                    <label for="examName" class="required">Entrance Exam</label>
                                    <select id="examName" name="examName" required>
                                        <option value="">Select Exam</option>
                                        <option value="gate">GATE</option>
                                        <option value="pgecet">PGECET</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="form-col">
                                    <label for="examYear" class="required">Exam Year</label>
                                    <select id="examYear" name="examYear" required>
                                        <option value="">Select Year</option>
                                        <option value="2023">2023</option>
                                        <option value="2024">2024</option>
                                        <option value="2025">2025</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-col">
                                    <label for="rank" class="required">Rank</label>
                                    <input type="number" id="rank" name="rank" min="1" required placeholder="Enter your rank">
                                </div>
                                <div class="form-col">
                                    <label for="score" class="required">Score</label>
                                    <input type="number" id="score" name="score" min="0" step="0.01" required placeholder="Enter your score">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="navigation-buttons">
                        <button type="button" class="btn btn-prev">Previous</button>
                        <button type="button" class="btn btn-next">Next</button>
                    </div>
                </div>
                
                <!-- Step 3: Upload Documents & Pre-Booking Fee Payment -->
                <div id="step-3" class="form-step">
                    <h3 class="section-title">Upload Documents</h3>
                    <div class="photo-upload">
                        <div class="photo-preview">
                            <img id="photoPreview" src="" alt="Photo Preview">
                            <i class="fas fa-camera"></i>
                            <span id="photoText">Upload Photo</span>
                        </div>
                        <div class="upload-instructions">
                            <p>Please upload a recent passport-size photograph.</p>
                            <ul>
                                <li><strong>Format:</strong> JPG, JPEG, PNG</li>
                                <li><strong>Max Size:</strong> 2MB</li>
                                <li><strong>Dimensions:</strong> 3.5cm x 4.5cm preferred</li>
                            </ul>
                            <input type="file" id="photoUpload" name="photoUpload" accept="image/jpeg,image/png" required>
                        </div>
                    </div>

                    <h3 class="section-title">Pre-Booking Fee Payment</h3>
                    <div class="fee-payment-section">
                        <div class="payment-summary">
                            <h2 class="summary-title">Payment Summary</h2>
                            <div class="summary-item">
                                <span>Total Estimated M.Tech Course Fees</span>
                                <span>₹ 2,00,000</span>
                            </div>
                            <div class="summary-item">
                                <span>Pre-Booking Advance Amount</span>
                                <span id="advanceAmountDisplay">₹ 1.00</span>
                                <input type="hidden" id="advanceAmount" value="1">
                            </div>
                            <div class="summary-total">
                                <span>Amount to Pay Now</span>
                                <span id="totalPaymentAmount">₹ 1.00</span>
                            </div>
                            
                            <div style="margin-top: 30px;">
                                <h3 style="margin-bottom: 15px;">Choose Payment Method</h3>
                                <div class="payment-methods">
                                    <div class="method-btn" data-method="upi">
                                        <div class="method-icon"><i class="fas fa-mobile-alt"></i></div>
                                        <div>PhonePe (Direct)</div>
                                    </div>
                                    <div class="method-btn active" data-method="qr">
                                        <div class="method-icon"><i class="fas fa-qrcode"></i></div>
                                        <div>QR Code</div>
                                    </div>
                                    <div class="method-btn" data-method="card">
                                        <div class="method-icon"><i class="fas fa-credit-card"></i></div>
                                        <div>Credit/Debit Card</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="payment-options-container">
                            <div class="payment-details-content">
                                <div id="upi-payment" class="payment-form">
                                    <h2 style="margin-bottom: 20px;">Pay with PhonePe (Direct App Launch)</h2>
                                    <div class="form-group">
                                        <label for="upi-id">Your UPI ID</label>
                                        <input type="text" id="upi-id" placeholder="e.g., name@ybl" value="9441459310@ybl">
                                    </div>
                                    <div class="form-group">
                                        <label for="upi-amount">Amount</label>
                                        <input type="text" id="upi-amount" readonly>
                                    </div>
                                    <div class="form-group">
                                        <label for="upi-transaction-note">Transaction Note</label>
                                        <input type="text" id="upi-transaction-note" placeholder="M.Tech Pre-Booking" value="M.Tech Pre-Booking">
                                    </div>
                                    <button type="button" class="btn" onclick="initiatePhonePePayment()">Pay with PhonePe</button>
                                    <p style="font-size: 14px; color: #666; margin-top: 10px;">(This button attempts to open the PhonePe app directly on this device.)</p>
                                </div>
                                
                                <div id="qr-payment" class="payment-form active">
                                    <h2 style="margin-bottom: 20px;">Scan QR Code to Pay</h2>
                                    <div class="upi-qr-container">
                                        <h3>Pay ₹<span id="qr-amount">0.00</span> to Global College</h3>
                                        <div class="qr-code">
                                            <img id="dynamic-qr-code" src="" alt="UPI QR Code">
                                        </div>
                                        <div class="qr-instructions">
                                            <p><strong>Easy Payment Instructions:</strong></p>
                                            <ol>
                                                <li>Open any UPI app (PhonePe, Google Pay, Paytm, BHIM, etc.) on <strong>another device</strong></li>
                                                <li>Tap on 'Scan QR Code' in your UPI app</li>
                                                <li>Point your camera at this QR code on *this screen*</li>
                                                <li>The amount ₹<span id="instr-amount">0.00</span> will be automatically filled</li>
                                                <li>Just enter your UPI PIN to complete payment</li>
                                            </ol>
                                            <p style="color: var(--primary); font-weight: bold; margin-top: 15px;">
                                                No need to enter amount manually - it's already set!
                                            </p>
                                        </div>
                                        <!-- NEW BUTTON ADDED HERE -->
                                        <button type="button" class="btn" onclick="simulatePayment()">I have paid (Simulate)</button>
                                    </div>
                                </div>
                                
                                <div id="card-payment" class="payment-form">
                                    <h2 style="margin-bottom: 20px;">Pay with Credit/Debit Card</h2>
                                    <div class="form-group">
                                        <label for="card-number">Card Number</label>
                                        <input type="text" id="card-number" placeholder="XXXX XXXX XXXX XXXX" maxlength="19">
                                    </div>
                                    <div class="form-group">
                                        <label for="card-name">Cardholder Name</label>
                                        <input type="text" id="card-name" placeholder="John Doe">
                                    </div>
                                    <div style="display: flex; gap: 15px;">
                                        <div class="form-group" style="flex: 1;">
                                            <label for="expiry">Expiry Date</label>
                                            <input type="text" id="expiry" placeholder="MM/YY" maxlength="5">
                                        </div>
                                        <div class="form-group" style="flex: 1;">
                                            <label for="cvv">CVV</label>
                                            <input type="text" id="cvv" placeholder="XXX" maxlength="4">
                                        </div>
                                    </div>
                                    <button type="button" class="btn" onclick="processCardPayment()">Pay with Card</button>
                                    <p style="font-size: 14px; color: #666; margin-top: 10px;">(Card details are for simulation only and will not be processed)</p>
                                </div>
                            </div>
                            
                            <div id="payment-status" class="payment-status">
                                <div class="status-icon"></div>
                                <h2></h2>
                                <p></p>
                                <div id="status-message" style="margin-top: 20px;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="receipt-upload-section" id="receiptUploadSection">
                        <label for="paymentReceipt">Upload Payment Receipt <span class="required">(PDF, JPG, PNG - Max 5MB)</span></label>
                        <input type="file" id="paymentReceipt" name="paymentReceipt" accept=".pdf,.jpg,.jpeg,.png">
                        <div class="receipt-preview-container" id="receiptPreviewContainer">
                            <div class="receipt-preview">
                                <img id="receiptPreview" src="" alt="Receipt Preview">
                                <i class="fas fa-file-invoice"></i>
                                <span id="receiptPreviewText">No file chosen</span>
                            </div>
                            <div class="upload-instructions">
                                <p>Please upload a clear image or PDF of your payment receipt.</p>
                                <ul>
                                    <li><strong>Format:</strong> JPG, JPEG, PNG, PDF</li>
                                    <li><strong>Max Size:</strong> 5MB</li>
                                    <li>Ensure all transaction details are visible.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-note">
                        <p><strong>Important Information:</strong></p>
                        <ul>
                            <li>This pre-booking form secures your application but does not guarantee admission</li>
                            <li>You will be contacted within 48 hours to complete the admission process</li>
                            <li>Original documents must be presented during admission</li>
                            <li>Scholarships available for eligible candidates</li>
                            <li>No application fee is required for pre-booking (only advance payment)</li>
                        </ul>
                    </div>

                    <div class="navigation-buttons">
                        <button type="button" class="btn btn-prev">Previous</button>
                        <button type="submit" class="btn">Submit Application</button>
                    </div>
                </div>
            </form>
            
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i>
                <h2>Application Submitted Successfully!</h2>
                <p>Thank you for applying to the M.Tech program at Global College of Engineering & Technology.</p>
                <p>Your admission is now **provisionally confirmed** for the selected M.Tech program for the academic year 2025-26.</p>
                <p>You will receive an email with further instructions regarding document verification and the next steps for your course enrollment within 2-3 business days.</p>
                <p style="font-weight: bold; margin-top: 20px;">Selected Course: <span id="finalCourseConfirmation"></span></p>
                <button type="button" class="btn" id="newForm">Submit Another Application</button>
            </div>
            
            <!-- Step 4: Application Receipt -->
            <div class="application-receipt" id="applicationReceipt">
                <div class="receipt-header">
                    <h2>GLOBAL COLLEGE OF ENGINEERING & TECHNOLOGY</h2>
                    <h3>M.Tech Admission Application Receipt</h3>
                    <p>Pre-Booking Confirmation for Academic Year 2025-26</p>
                </div>
                
                <div class="receipt-details">
                    <div>
                        <div class="receipt-row">
                            <div class="receipt-label">Application ID:</div>
                            <div class="receipt-value" id="receiptAppId">GCET-2025-001234</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Submission Date:</div>
                            <div class="receipt-value" id="receiptDate">July 15, 2025</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Status:</div>
                            <div class="receipt-value" id="receiptStatus" style="color: var(--success); font-weight: 700;">Application Received</div>
                        </div>
                    </div>
                    <div>
                        <div class="receipt-row">
                            <div class="receipt-label">Student Name:</div>
                            <div class="receipt-value" id="receiptName">-</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Contact Phone:</div>
                            <div class="receipt-value" id="receiptPhone">-</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Email:</div>
                            <div class="receipt-value" id="receiptEmail">-</div>
                        </div>
                    </div>
                </div>
                
                <div class="receipt-section">
                    <h3 class="receipt-section-title">Academic Details</h3>
                    <div class="receipt-row">
                        <div class="receipt-label">Degree College:</div>
                        <div class="receipt-value" id="receiptDegreeCollege">-</div>
                    </div>
                    <div class="receipt-row">
                        <div class="receipt-label">Degree University:</div>
                        <div class="receipt-value" id="receiptDegreeUniversity">-</div>
                    </div>
                    <div class="receipt-row">
                        <div class="receipt-label">Degree Percentage:</div>
                        <div class="receipt-value" id="receiptDegreePercent">-</div>
                    </div>
                    <div class="receipt-row">
                        <div class="receipt-label">UG Stream:</div>
                        <div class="receipt-value" id="receiptDegreeStream">-</div>
                    </div>
                    <div class="receipt-row">
                        <div class="receipt-label">Preferred Specialization:</div>
                        <div class="receipt-value" id="receiptSpecialization">-</div>
                    </div>
                </div>
                
                <div class="receipt-section">
                    <h3 class="receipt-section-title">Payment Details</h3>
                    <div class="payment-details">
                        <div class="receipt-row">
                            <div class="receipt-label">Payment Type:</div>
                            <div class="receipt-value" id="receiptPaymentType">-</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Amount Paid:</div>
                            <div class="receipt-value" id="receiptAmount">-</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Transaction ID:</div>
                            <div class="receipt-value" id="receiptTxnId">-</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Payment Method:</div>
                            <div class="receipt-value" id="receiptPaymentMethod">-</div>
                        </div>
                        <div class="receipt-row">
                            <div class="receipt-label">Payment Status:</div>
                            <div class="receipt-value" id="receiptPaymentStatus" style="color: var(--success); font-weight: 700;">Completed</div>
                        </div>
                    </div>
                </div>
                
                <div class="receipt-section">
                    <h3 class="receipt-section-title">Next Steps</h3>
                    <div class="receipt-row">
                        <div class="receipt-label">Verification Process:</div>
                        <div class="receipt-value">Our admission team will contact you within 48 hours to verify your documents and complete the admission process.</div>
                    </div>
                    <div class="receipt-row">
                        <div class="receipt-label">Required Documents:</div>
                        <div class="receipt-value">10th, Intermediate, B.Tech/B.E. Marksheets, GATE/PGECET Score Card, TC, CC, ID Proof, Passport Photos</div>
                    </div>
                </div>
                
                <div class="receipt-footer">
                    <p>This is a computer-generated receipt and does not require a physical signature.</p>
                    <p>For any queries, contact admissions.glbc@gmail.com or call 9398302073</p>
                    <div class="signature-area">
                        <div class="signature-line">Authorized Signature</div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button type="button" class="btn" id="printReceipt">Print Receipt</button>
                    <button type="button" class="btn btn-secondary" id="downloadReceipt">Download as PDF</button>
                </div>
            </div>
            
            <div class="contact-info">
                <p><i class="fas fa-phone"></i> Admission Helpline: 9398302073, 7729988041</p>
                <p><i class="fas fa-envelope"></i> Email: admissions.glbc@gmail.com</p>
                <p><i class="fas fa-map-marker-alt"></i> Near Toll Plaza, NH-40, Chinnamachupalli (V), Chennur (M), KADAPA - 516 162</p>
            </div>
        </div>
    </div>

    <!-- Custom Message Box HTML -->
    <div class="message-box-overlay" id="messageBoxOverlay">
        <div class="message-box" id="messageBox">
            <h3 id="messageBoxTitle"></h3>
            <p id="messageBoxMessage"></p>
            <button type="button" class="btn" id="messageBoxCloseBtn">OK</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('mtechAdmissionForm');
            const successMessage = document.getElementById('successMessage');
            const newFormBtn = document.getElementById('newForm');
            const paymentStatusDiv = document.getElementById('payment-status');
            const receiptUploadSection = document.getElementById('receiptUploadSection');
            const advanceAmountInput = document.getElementById('advanceAmount');
            const advanceAmountDisplay = document.getElementById('advanceAmountDisplay');
            const totalPaymentAmount = document.getElementById('totalPaymentAmount');
            const applicationReceipt = document.getElementById('applicationReceipt');
            const printReceiptBtn = document.getElementById('printReceipt');
            const downloadReceiptBtn = document.getElementById('downloadReceipt');

            const admissionTypeRadios = document.querySelectorAll('input[name="admissionType"]');
            const entranceExamDetails = document.getElementById('entranceExamDetails');
            const examNameInput = document.getElementById('examName');
            const examYearInput = document.getElementById('examYear');
            const rankInput = document.getElementById('rank');
            const scoreInput = document.getElementById('score');

            const paymentMethodBtns = document.querySelectorAll('.method-btn');
            const upiPaymentContent = document.getElementById('upi-payment');
            const qrPaymentContent = document.getElementById('qr-payment');
            const cardPaymentContent = document.getElementById('card-payment');
            const upiAmountInput = document.getElementById('upi-amount');
            const qrAmountDisplay = document.getElementById('qr-amount');
            const instrAmountDisplay = document.getElementById('instr-amount');
            const cardNumberInput = document.getElementById('card-number');
            const expiryDateInput = document.getElementById('expiry');
            const cvvInput = document.getElementById('cvv');

            // Multi-step form elements
            const formSteps = document.querySelectorAll('.form-step'); // These are step-1, step-2, step-3
            const progressBar = document.getElementById('progressBar');
            const stepIndicators = document.querySelectorAll('.step-indicator'); // These are 4 visual indicators
            let currentStep = 1; // Start at Step 1

            // Custom Message Box elements
            const messageBoxOverlay = document.getElementById('messageBoxOverlay');
            const messageBox = document.getElementById('messageBox');
            const messageBoxTitle = document.getElementById('messageBoxTitle');
            const messageBoxMessage = document.getElementById('messageBoxMessage');
            const messageBoxCloseBtn = document.getElementById('messageBoxCloseBtn');

            // --- Payment Logic Variables ---
            let isPaymentCompleted = false; // Flag to track simulated payment status
            let transactionId = ''; // Store generated transaction ID

            // Photo Upload Preview Logic
            const photoUpload = document.getElementById('photoUpload');
            const photoPreview = document.getElementById('photoPreview');
            const photoText = document.getElementById('photoText');

            photoUpload.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        photoPreview.src = e.target.result;
                        photoPreview.style.display = 'block';
                        photoText.style.display = 'none'; // Hide "Upload Photo" text
                    };
                    reader.readAsDataURL(file);
                } else {
                    photoPreview.src = '';
                    photoPreview.style.display = 'none';
                    photoText.style.display = 'block'; // Show "Upload Photo" text
                }
            });

            // Receipt Upload Preview Logic
            const paymentReceiptInput = document.getElementById('paymentReceipt');
            const receiptPreviewContainer = document.getElementById('receiptPreviewContainer');
            const receiptPreview = document.getElementById('receiptPreview');
            const receiptPreviewText = document.getElementById('receiptPreviewText');

            paymentReceiptInput.addEventListener('change', function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        receiptPreview.src = e.target.result;
                        receiptPreview.style.display = 'block';
                        receiptPreviewText.textContent = file.name; // Show file name
                        receiptPreviewText.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                    // Show the preview container if a file is selected
                    receiptPreviewContainer.style.display = 'flex';
                } else {
                    receiptPreview.src = '';
                    receiptPreview.style.display = 'none';
                    receiptPreviewText.textContent = 'No file chosen';
                    receiptPreviewText.style.display = 'block';
                    // Hide the preview container if no file is selected
                    receiptPreviewContainer.style.display = 'none';
                }
            });


            // Function to show custom message box
            function showMessage(title, message, type = 'info') {
                messageBoxTitle.textContent = title;
                messageBoxMessage.textContent = message;
                messageBox.className = 'message-box ' + type; // Add type class for styling (e.g., 'error', 'warning')
                messageBoxOverlay.classList.add('active');
            }

            // Function to hide custom message box
            messageBoxCloseBtn.addEventListener('click', function() {
                messageBoxOverlay.classList.remove('active');
            });


            // Function to update payment amount and exam details based on admission type
            function updateAdmissionTypeDisplay() {
                const amount = 1; // Fixed amount for this request
                const amountText = '₹ 1.00';

                const selectedAdmissionType = document.querySelector('input[name="admissionType"]:checked').value;
                if (selectedAdmissionType === 'qualified') {
                    entranceExamDetails.style.display = 'block'; // Show exam details
                    examNameInput.setAttribute('required', 'required');
                    examYearInput.setAttribute('required', 'required');
                    rankInput.setAttribute('required', 'required');
                    scoreInput.setAttribute('required', 'required');
                } else if (selectedAdmissionType === 'paid') {
                    entranceExamDetails.style.display = 'none'; // Hide exam details
                    examNameInput.removeAttribute('required');
                    examYearInput.removeAttribute('required');
                    rankInput.removeAttribute('required');
                    scoreInput.removeAttribute('required');
                    examNameInput.value = '';
                    examYearInput.value = '';
                    rankInput.value = '';
                    scoreInput.value = '';
                }

                advanceAmountInput.value = amount;
                advanceAmountDisplay.textContent = amountText;
                totalPaymentAmount.textContent = amountText;

                upiAmountInput.value = amount.toFixed(2);
                qrAmountDisplay.textContent = amount.toFixed(2);
                instrAmountDisplay.textContent = amount.toFixed(2);
                updateQRCode();

                resetPaymentSection();
            }

            // Function to show/hide payment method specific content
            function switchPaymentMethod(method) {
                upiPaymentContent.classList.remove('active');
                qrPaymentContent.classList.remove('active');
                cardPaymentContent.classList.remove('active');

                paymentMethodBtns.forEach(btn => btn.classList.remove('active'));

                document.getElementById(`${method}-payment`).classList.add('active');
                document.querySelector(`.method-btn[data-method="${method}"]`).classList.add('active');

                if (method === 'qr') {
                    updateQRCode();
                }

                resetPaymentSection();
            }

            // Function to reset payment status and receipt upload section
            function resetPaymentSection() {
                isPaymentCompleted = false;
                paymentStatusDiv.classList.remove('active');
                paymentStatusDiv.className = 'payment-status';
                paymentStatusDiv.querySelector('.status-icon').innerHTML = '';
                paymentStatusDiv.querySelector('h2').textContent = '';
                paymentStatusDiv.querySelector('p').textContent = '';
                paymentStatusDiv.querySelector('#status-message').innerHTML = '';
                receiptUploadSection.style.display = 'none';
                document.getElementById('paymentReceipt').value = '';
                document.getElementById('paymentReceipt').style.borderColor = '#ced4da';
                receiptPreviewContainer.style.display = 'none'; // Hide receipt preview
                receiptPreview.src = '';
                receiptPreview.style.display = 'none';
                receiptPreviewText.textContent = 'No file chosen';
            }

            // Update the QR code with current amount and merchant details
            function updateQRCode() {
                const amount = parseFloat(advanceAmountInput.value).toFixed(2);
                const merchantUpiId = "9441459310@ybl";
                const merchantName = "Global College of Engineering & Technology";
                const transactionNote = "M.Tech Pre-Booking Payment";
                
                const upiUrl = `upi://pay?pa=${merchantUpiId}&pn=${encodeURIComponent(merchantName)}&am=${amount}&cu=INR&tn=${encodeURIComponent(transactionNote)}`;
                
                document.getElementById('dynamic-qr-code').src = 
                    `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(upiUrl)}`;
                
                qrAmountDisplay.textContent = amount;
                instrAmountDisplay.textContent = amount;
            }

            // Simulate payment processing (triggered by buttons inside payment forms)
            window.simulatePayment = function() {
                const currentAdvanceAmount = parseFloat(advanceAmountInput.value).toFixed(2);
                const activePaymentMethod = document.querySelector('.payment-form.active').id.replace('-payment', '');
                let paymentDetails = {};
                let isPaymentInfoValid = true;

                if (activePaymentMethod === 'card') {
                    if (!cardNumberInput.value.trim() || !expiryDateInput.value.trim() || !cvvInput.value.trim()) {
                        isPaymentInfoValid = false;
                        console.log('Please fill in all card details.');
                        if (!cardNumberInput.value.trim()) cardNumberInput.style.borderColor = 'red'; else cardNumberInput.style.borderColor = '#ced4da';
                        if (!expiryDateInput.value.trim()) expiryDateInput.style.borderColor = 'red'; else expiryDateInput.style.borderColor = '#ced4da';
                        if (!cvvInput.value.trim()) cvvInput.style.borderColor = 'red'; else cvvInput.style.borderColor = '#ced4da';
                        return;
                    } else {
                        cardNumberInput.style.borderColor = '#ced4da';
                        expiryDateInput.style.borderColor = '#ced4da';
                        cvvInput.style.borderColor = '#ced4da';
                        paymentDetails = {
                            method: 'Credit/Debit Card',
                            cardNumber: cardNumberInput.value,
                            expiryDate: expiryDateInput.value,
                            cvv: cvvInput.value
                        };
                    }
                } else if (activePaymentMethod === 'upi') {
                    const upiId = document.getElementById('upi-id').value;
                    if (!upiId.trim()) {
                        isPaymentInfoValid = false;
                        console.log('Please enter your UPI ID.');
                        document.getElementById('upi-id').style.borderColor = 'red';
                        return;
                    } else {
                        document.getElementById('upi-id').style.borderColor = '#ced4da';
                        paymentDetails = {
                            method: 'PhonePe (Direct App)',
                            upiId: upiId
                        };
                    }
                } else if (activePaymentMethod === 'qr') {
                    paymentDetails = {
                        method: 'QR Code',
                        upiId: '9441459310@ybl'
                    };
                }

                if (!isPaymentInfoValid) return;

                // Simulate success or failure
                const success = Math.random() > 0.2; // 80% chance of success
                
                if (success) {
                    isPaymentCompleted = true;
                    transactionId = 'TXN' + Math.floor(1000000000 + Math.random() * 9000000000);
                    
                    // Hide payment status div and immediately show receipt upload
                    paymentStatusDiv.classList.remove('active');
                    paymentStatusDiv.className = 'payment-status'; // Reset class
                    paymentStatusDiv.querySelector('h2').textContent = '';
                    paymentStatusDiv.querySelector('p').textContent = '';
                    paymentStatusDiv.querySelector('#status-message').innerHTML = '';
                    paymentStatusDiv.querySelector('.status-icon').innerHTML = '';

                    receiptUploadSection.style.display = 'block';
                    receiptPreviewContainer.style.display = 'flex';
                    
                    // Scroll to the receipt upload section
                    receiptUploadSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                } else {
                    isPaymentCompleted = false;
                    paymentStatusDiv.classList.add('active');
                    paymentStatusDiv.querySelector('.status-icon').className = 'status-icon status-error';
                    paymentStatusDiv.querySelector('.status-icon').innerHTML = '❌';
                    paymentStatusDiv.querySelector('h2').textContent = 'Payment Failed';
                    paymentStatusDiv.querySelector('p').textContent = 'We couldn\'t process your payment. Please try again.';
                    
                    document.getElementById('status-message').innerHTML = `
                        <button type="button" class="btn" onclick="retryPayment()" style="margin-top: 20px;">Retry Payment</button>
                    `;
                    paymentStatusDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            };

            window.retryPayment = function() {
                paymentStatusDiv.classList.remove('active');
                const activeMethod = document.querySelector('.method-btn.active').dataset.method;
                document.getElementById(`${activeMethod}-payment`).classList.add('active');
                resetPaymentSection();
            }
            
            window.processCardPayment = function() {
                const cardNumber = document.getElementById('card-number').value;
                const cardName = document.getElementById('card-name').value;
                const expiry = document.getElementById('expiry').value;
                const cvv = document.getElementById('cvv').value;
                
                if (!cardNumber || !cardName || !expiry || !cvv) {
                    showMessage('Input Error', 'Please fill in all card details.', 'error');
                    if (!cardNumber) cardNumberInput.style.borderColor = 'red'; else cardNumberInput.style.borderColor = '#ced4da';
                    if (!expiry) expiryDateInput.style.borderColor = 'red'; else expiryDateInput.style.borderColor = '#ced4da';
                    if (!cvv) cvvInput.style.borderColor = 'red'; else cvvInput.style.borderColor = '#ced4da';
                    return;
                } else {
                    cardNumberInput.style.borderColor = '#ced4da';
                    expiryDateInput.style.borderColor = '#ced4da';
                    cvvInput.style.borderColor = '#ced4da';
                }
                simulatePayment();
            };
            
            window.initiatePhonePePayment = function() {
                const upiId = document.getElementById('upi-id').value;
                const amount = document.getElementById('upi-amount').value;
                const note = document.getElementById('upi-transaction-note').value;
                
                if (!upiId.trim()) {
                    showMessage('Input Error', 'Please enter your UPI ID.', 'error');
                    document.getElementById('upi-id').style.borderColor = 'red';
                    return;
                } else {
                    document.getElementById('upi-id').style.borderColor = '#ced4da';
                }

                const upiUrl = `upi://pay?pa=${upiId}&pn=Global%20College%20of%20Engineering%20%26%20Technology&am=${amount}&cu=INR&tn=${encodeURIComponent(note)}`;
                
                // Attempt to open PhonePe app (will likely not work in browser iframe)
                // window.location.href = upiUrl;
                
                // Simulate payment success immediately for demonstration
                console.log('Attempted to open PhonePe. Simulating payment success for demonstration.');
                simulatePayment();
            };

            // Function to generate application receipt
            function generateReceipt(formData) {
                const today = new Date();
                const formattedDate = today.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                const appId = 'GCETM-' + today.getFullYear() + '-' + Math.floor(1000 + Math.random() * 9000);
                
                document.getElementById('receiptAppId').textContent = appId;
                document.getElementById('receiptDate').textContent = formattedDate;
                document.getElementById('receiptName').textContent = formData.fullName;
                document.getElementById('receiptPhone').textContent = formData.phone;
                document.getElementById('receiptEmail').textContent = formData.email;
                
                document.getElementById('receiptDegreeCollege').textContent = formData.degreeCollege;
                document.getElementById('receiptDegreeUniversity').textContent = formData.degreeUniversity;
                document.getElementById('receiptDegreePercent').textContent = formData.degreePercentage + '%';
                document.getElementById('receiptDegreeStream').textContent = formData.degreeStream;
                
                const specializationMap = {
                    'cse': 'Computer Science & Engineering',
                    'ps': 'Power Systems',
                    'tses': 'Thermal Engineering & Solar Energy Systems',
                    'vlsid': 'VLSI Design',
                    'cpm': 'Construction Project Management',
                    'decs': 'Digital Electronics & Communication Systems',
                    'other': 'Other'
                };
                document.getElementById('receiptSpecialization').textContent = specializationMap[formData.specialization] || formData.specialization;
                
                document.getElementById('receiptPaymentType').textContent = formData.admissionType === 'qualified' ? 
                    'Entrance Exam Qualified' : 'Management Quota';
                document.getElementById('receiptAmount').textContent = '₹ ' + advanceAmountInput.value + '.00';
                document.getElementById('receiptTxnId').textContent = transactionId || 'N/A';
                
                const paymentMethod = document.querySelector('.method-btn.active').dataset.method;
                const methodMap = {
                    'upi': 'PhonePe (Direct App)',
                    'qr': 'QR Code',
                    'card': 'Credit/Debit Card'
                };
                document.getElementById('receiptPaymentMethod').textContent = methodMap[paymentMethod] || paymentMethod;
                document.getElementById('finalCourseConfirmation').textContent = specializationMap[formData.specialization] || formData.specialization;
            }

            // Print receipt
            printReceiptBtn.addEventListener('click', function() {
                const printContents = applicationReceipt.innerHTML;
                const originalContents = document.body.innerHTML;
                
                document.body.innerHTML = `
                    <div style="max-width: 800px; margin: 0 auto; padding: 30px;">
                        ${printContents}
                    </div>
                `;
                
                window.print();
                document.body.innerHTML = originalContents;
                window.location.reload();
            });

            // Download as PDF
            downloadReceiptBtn.addEventListener('click', async function() {
                // Temporarily hide buttons for cleaner PDF capture
                const buttonsToHide = applicationReceipt.querySelectorAll('.btn, .btn-secondary');
                buttonsToHide.forEach(btn => btn.style.display = 'none');

                // Get the receipt element
                const element = document.getElementById('applicationReceipt');

                // Use html2canvas to render the element to a canvas
                html2canvas(element, { 
                    scale: 2, // Increase scale for better quality
                    useCORS: true // Enable cross-origin images if any
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const { jsPDF } = window.jspdf; // Access jsPDF from the UMD bundle
                    const pdf = new jsPDF('p', 'mm', 'a4'); // Portrait, millimeters, A4 size

                    const imgWidth = 210; // A4 width in mm
                    const pageHeight = 297; // A4 height in mm
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    let heightLeft = imgHeight;
                    let position = 0;

                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;

                    while (heightLeft >= 0) {
                        position = heightLeft - imgHeight;
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }
                    
                    pdf.save('MTech_Admission_Receipt.pdf');
                }).catch(error => {
                    console.error('Error generating PDF:', error);
                    showMessage('PDF Generation Error', 'Could not generate PDF. Please try again or use the print option.', 'error');
                }).finally(() => {
                    // Show buttons again after PDF generation attempt
                    buttonsToHide.forEach(btn => btn.style.display = 'inline-block');
                });
            });

            // Multi-step form logic
            function updateProgressBar() {
                // Progress is based on 4 visual stages (including Receipt)
                const progress = ((currentStep - 1) / (stepIndicators.length - 1)) * 100;
                progressBar.style.width = `${progress}%`;
            }

            function updateStepIndicators() {
                stepIndicators.forEach((indicator, index) => {
                    const indicatorStepNum = index + 1;
                    indicator.classList.remove('active', 'completed');
                    if (indicatorStepNum < currentStep) {
                        indicator.classList.add('completed');
                    } else if (indicatorStepNum === currentStep) {
                        indicator.classList.add('active');
                    }
                });
            }

            function showStep(stepNum) {
                // Hide all form steps first
                formSteps.forEach(step => step.classList.remove('active'));
                // Also hide success message and receipt by default
                successMessage.style.display = 'none';
                applicationReceipt.style.display = 'none';

                // Activate the current form step if it's one of the interactive ones (1, 2, 3)
                if (stepNum >= 1 && stepNum <= 3) {
                    document.getElementById(`step-${stepNum}`).classList.add('active');
                    form.style.display = 'block'; // Ensure the form is visible for interactive steps
                } else if (stepNum === 4) { // Special handling for the Receipt step
                    form.style.display = 'none'; // Hide the form entirely
                    successMessage.style.display = 'block'; // Show success message
                    applicationReceipt.style.display = 'block'; // Show receipt
                }

                updateProgressBar();
                updateStepIndicators();

                // Manage navigation buttons visibility for the current *form* step
                // Only apply this logic if we are on an actual form step (1, 2, or 3)
                if (stepNum >= 1 && stepNum <= 3) {
                    const currentNavButtons = document.querySelector(`#step-${stepNum} .navigation-buttons`);
                    const prevBtn = currentNavButtons ? currentNavButtons.querySelector('.btn-prev') : null;
                    const nextBtn = currentNavButtons ? currentNavButtons.querySelector('.btn-next') : null;
                    const submitBtn = currentNavButtons ? currentNavButtons.querySelector('.btn[type="submit"]') : null;

                    if (currentNavButtons) {
                        currentNavButtons.style.display = 'flex'; // Ensure the container is visible
                    }

                    if (prevBtn) {
                        prevBtn.style.visibility = stepNum === 1 ? 'hidden' : 'visible';
                    }

                    if (nextBtn) {
                        // Show Next button for Step 1 and Step 2
                        nextBtn.style.display = (stepNum === 1 || stepNum === 2) ? 'inline-block' : 'none';
                    }
                    if (submitBtn) {
                        // Show Submit button only for Step 3
                        submitBtn.style.display = (stepNum === 3) ? 'inline-block' : 'none';
                    }
                }

                // Scroll to top of the form
                form.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            function validateStep(stepNum) {
                let isValid = true;
                const currentFormStep = document.getElementById(`step-${stepNum}`);
                const requiredFields = currentFormStep.querySelectorAll('[required]');
                
                requiredFields.forEach(field => {
                    if (field.offsetParent !== null) { // Check if field is visible
                        if (!field.value.trim()) {
                            isValid = false;
                            field.style.borderColor = 'red';
                        } else {
                            field.style.borderColor = '#ced4da';
                        }
                    }
                });

                // Specific validations per step
                if (stepNum === 1) {
                    const emailField = document.getElementById('email');
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (emailField.value && !emailRegex.test(emailField.value)) {
                        isValid = false;
                        emailField.style.borderColor = 'red';
                    }

                    const degreePercentageField = document.getElementById('degreePercentage');
                    if (degreePercentageField.value && (parseFloat(degreePercentageField.value) < 0 || parseFloat(degreePercentageField.value) > 100)) {
                        isValid = false;
                        degreePercentageField.style.borderColor = 'red';
                    }

                    const intermediatePercentageField = document.getElementById('intermediatePercentage');
                    if (intermediatePercentageField.value && (parseFloat(intermediatePercentageField.value) < 0 || parseFloat(intermediatePercentageField.value) > 100)) {
                        isValid = false;
                        intermediatePercentageField.style.borderColor = 'red';
                    }
                } else if (stepNum === 2) {
                    const specializationSelected = document.querySelector('input[name="specialization"]:checked');
                    if (!specializationSelected) {
                        isValid = false;
                        document.querySelector('.specialization').style.borderColor = 'red';
                    } else {
                        document.querySelector('.specialization').style.borderColor = '#e0d7ff';
                    }
                } else if (stepNum === 3) {
                    const photoFile = document.getElementById('photoUpload').files[0];
                    if (!photoFile) {
                        isValid = false;
                        document.getElementById('photoUpload').style.borderColor = 'red';
                    } else {
                        document.getElementById('photoUpload').style.borderColor = '#ced4da';
                    }

                    if (!isPaymentCompleted) {
                        isValid = false;
                        showMessage('Payment Required', 'Please complete the simulated payment first by clicking one of the "Pay" buttons.', 'error');
                        document.querySelector('.fee-payment-section').scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }

                    if (isPaymentCompleted && receiptUploadSection.style.display === 'block') {
                        const receiptFile = document.getElementById('paymentReceipt').files[0];
                        if (!receiptFile) {
                            isValid = false;
                            document.getElementById('paymentReceipt').style.borderColor = 'red';
                            showMessage('Receipt Missing', 'Please upload your payment receipt.', 'error');
                            document.getElementById('paymentReceipt').scrollIntoView({ behavior: 'smooth', block: 'center' });
                        } else {
                            document.getElementById('paymentReceipt').style.borderColor = '#ced4da';
                        }
                    }
                }
                
                return isValid;
            }

            function nextStep() {
                if (validateStep(currentStep)) {
                    if (currentStep < 3) { // Only allow next if currentStep is 1 or 2
                        currentStep++;
                        showStep(currentStep);
                    }
                } else {
                    // Message already shown by validateStep
                }
            }

            function prevStep() {
                if (currentStep > 1) {
                    currentStep--;
                    showStep(currentStep);
                }
            }

            // Event listeners for navigation buttons
            document.querySelectorAll('.btn-next').forEach(button => {
                button.addEventListener('click', nextStep);
            });

            document.querySelectorAll('.btn-prev').forEach(button => {
                button.addEventListener('click', prevStep);
            });

            // Event listeners for step indicators (for direct navigation)
            stepIndicators.forEach(indicator => {
                indicator.addEventListener('click', function() {
                    const targetStep = parseInt(this.dataset.step);
                    if (targetStep < currentStep) { // Allow going back freely
                        currentStep = targetStep;
                        showStep(currentStep);
                    } else if (validateStep(currentStep) && targetStep === currentStep + 1) { // Allow going forward one step if current is valid
                        currentStep = targetStep;
                        showStep(currentStep);
                    } else if (targetStep > currentStep) { // Prevent skipping steps without validation
                        showMessage('Validation Error', 'Please complete the current step before proceeding.', 'warning');
                    }
                });
            });

            // Form submission handler (only on the last form step)
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                if (validateStep(currentStep)) {
                    const formData = {
                        fullName: document.getElementById('fullName').value,
                        dob: document.getElementById('dob').value,
                        fatherName: document.getElementById('fatherName').value,
                        motherName: document.getElementById('motherName').value,
                        degreeCollege: document.getElementById('degreeCollege').value,
                        degreeUniversity: document.getElementById('degreeUniversity').value,
                        degreePercentage: document.getElementById('degreePercentage').value,
                        degreeYear: document.getElementById('degreeYear').value,
                        degreeStream: document.getElementById('degreeStream').value,
                        intermediatePercentage: document.getElementById('intermediatePercentage').value,
                        specialization: document.querySelector('input[name="specialization"]:checked').value,
                        email: document.getElementById('email').value,
                        phone: document.getElementById('phone').value,
                        address: document.getElementById('address').value,
                        city: document.getElementById('city').value,
                        state: document.getElementById('state').value,
                        pincode: document.getElementById('pincode').value,
                        admissionType: document.querySelector('input[name="admissionType"]:checked').value,
                        examName: document.getElementById('examName').value,
                        examYear: document.getElementById('examYear').value,
                        rank: document.getElementById('rank').value,
                        score: document.getElementById('score').value
                    };
                    
                    generateReceipt(formData); // Generate receipt data first
                    currentStep = 4; // Advance to the receipt step
                    showStep(currentStep); // Call showStep to display the receipt
                    console.log('Form submitted:', formData);
                } else {
                    // Message already shown by validateStep
                }
            });
            
            // New form handler
            newFormBtn.addEventListener('click', function() {
                form.reset();
                // Reset display states that showStep(1) might not fully cover
                form.style.display = 'block';
                successMessage.style.display = 'none';
                applicationReceipt.style.display = 'none';
                
                resetPaymentSection();
                
                const fields = form.querySelectorAll('input, select, textarea');
                fields.forEach(field => {
                    field.style.borderColor = '#ced4da';
                });
                
                document.querySelector('.specialization').style.borderColor = '#e0d7ff';

                document.getElementById('admissionTypeQualified').checked = true;
                updateAdmissionTypeDisplay();
                switchPaymentMethod('qr');

                currentStep = 1;
                showStep(currentStep); // Show the first step on reset
            });
            
            // Input validation for phone and pincode
            const phoneInput = document.getElementById('phone');
            phoneInput.addEventListener('input', function() {
                this.value = this.value.replace(/[^0-9+]/g, '');
                if (this.value.length > 15) {
                    this.value = this.value.slice(0, 15);
                }
            });
            
            const pincodeInput = document.getElementById('pincode');
            pincodeInput.addEventListener('input', function() {
                this.value = this.value.replace(/\D/g, '');
                if (this.value.length > 6) {
                    this.value = this.value.slice(0, 6);
                }
            });

            // Card number formatting
            cardNumberInput.addEventListener('input', function() {
                this.value = this.value.replace(/\D/g, '').replace(/(.{4})/g, '$1 ').trim();
            });

            // Expiry date formatting MM/YY
            expiryDateInput.addEventListener('input', function() {
                let value = this.value.replace(/\D/g, '');
                if (value.length > 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                this.value = value;
            });

            // CVV validation
            cvvInput.addEventListener('input', function() {
                this.value = this.value.replace(/\D/g, '');
            });

            // Initial setup
            updateAdmissionTypeDisplay();
            switchPaymentMethod('qr');
            showStep(currentStep); // Display the first step on load
        });
    </script>
</body>
</html>
